import pandas as pd

transactions = pd.read_csv('transactions.csv') #we can replace with user added csv file

# Calculate the gains for 'buy' and 'sell' transactions

#For Buy

buy_transactions = transactions[transactions['transaction_type'] == 'buy']
buy_transactions['buy_value'] = buy_transactions['asset_quantity'] * buy_transactions['total_asset_amount_usd']
buy_gains = buy_transactions.groupby(['user_id', 'asset_purchased_name', 'asset_quantity'])['buy_value'].sum()

#For sell
sell_transactions = transactions[transactions['transaction_type'] == 'sell']
sell_transactions['sell_value'] = sell_transactions['asset_quantity'] * sell_transactions['total_asset_amount_usd']
sell_gains = sell_transactions.groupby(['user_id', 'asset_sold_name', 'asset_quantity'])['sell_value'].sum()

# Calculate gains for 'deposit' and 'withdraw' transactions
deposit_transactions = transactions[transactions['transaction_type'] == 'deposit']
withdraw_transactions = transactions[transactions['transaction_type'] == 'withdraw']

#Gains for Deposit and withdrawl
deposit_gains = deposit_transactions.groupby(['user_id', 'asset_name'])['total_asset_amount_usd'].sum()
withdraw_gains = withdraw_transactions.groupby(['user_id', 'asset_name'])['total_asset_amount_usd'].sum()

buy_and_sell_gains = sell_gains - buy_gains
deposit_and_withdrawl = deposit_gains - withdraw_gains

# Calculate the net gains for each asset
net_gains = (buy_and_sell_gains) + (deposit_and_withdrawl)

print("Net Gains:",net_gains)
